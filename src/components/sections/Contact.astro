---
import Icons from '../Icons.astro';
import { getLangFromUrl, useTranslations } from '../../i18n';
import { Toaster } from 'sonner';
import ContactForm from '../ContactForm';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const socialLinks: {
  href: string;
  label: string;
  icon: "github" | "linkedin" | "mail";
}[] = [
  { href: "https://github.com/idiegoo", label: "GitHub", icon: "github" },
  { href: "https://linkedin.com/in/idiegoo", label: "LinkedIn", icon: "linkedin" },
  { href: "mailto:idiegoo.aguirre@gmail.com", label: "Email", icon: "mail" },
];

// Prepare translations for React component
const formTranslations = {
  name: t('contact.name'),
  email: t('contact.email'),
  message: t('contact.message'),
  send: t('contact.send'),
  sending: lang === 'es' ? 'Enviando...' : 'Sending...',
  successMessage: lang === 'es'
    ? '¡Mensaje enviado con éxito! Te responderé muy pronto =)'
    : 'Message sent successfully! I\'ll get back to you soon =)',
  errorMessage: lang === 'es'
    ? 'Error al enviar el mensaje. Por favor intenta de nuevo.'
    : 'Failed to send message. Please try again.',
};
---

<section id="contact" class="py-20 px-4">
  <div class="max-w-4xl mx-auto">
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-purple-400 to-green-400 bg-clip-text text-transparent md:py-1">
        {t('contact.title')}
      </h2>
      <p class="text-lg text-gray-400 max-w-2xl mx-auto">
        {t('contact.description')}
      </p>
    </div>

    <div class="grid md:grid-cols-2 gap-12 items-start">
      <!-- Contact Form -->
      <div class="space-y-6">
        <ContactForm lang={lang} translations={formTranslations} client:visible />
      </div>

      <!-- Contact Info & Social Links -->
      <div class="space-y-8">
        <div class="bg-gray-900 border border-gray-800 rounded-lg p-6 space-y-6">
          <h3 class="text-xl font-semibold text-white mb-4">
            {t('contact.getInTouch')}
          </h3>

          <div class="space-y-4">
            {socialLinks.map(({ href, label, icon }) => (
              <a
                href={href}
                class="flex items-center gap-4 p-3 rounded-md border border-gray-800 hover:bg-gray-800 transition-all duration-200 group"
                target="_blank"
                rel="noopener noreferrer"
              >
                <div class={`p-2 rounded-full transition-all duration-300 ${
                  icon === 'github'
                    ? 'bg-gray-500/10 text-gray-400 group-hover:bg-gray-500/20 group-hover:text-gray-300'
                    : icon === 'linkedin'
                    ? 'bg-blue-500/10 text-blue-400 group-hover:bg-blue-500/20 group-hover:text-blue-400'
                    : icon === 'mail'
                    ? 'bg-red-500/10 text-red-400 group-hover:bg-red-500/20 group-hover:text-red-400'
                    : ''
                }`}>
                  <Icons icon={icon} size={20} />
                </div>
                <span class="text-white group-hover:text-purple-400 transition-colors">
                  {label}
                </span>
              </a>
            ))}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<Toaster position="bottom-right" richColors client:load />
