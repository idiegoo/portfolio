---
import Icons from "../Icons.astro";
import { getLangFromUrl, useTranslations } from "../../i18n";
import RotatingText from "../RotatingText";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const socialLinks: {
  href: string;
  label: string;
  icon: "github" | "linkedin" | "mail";
}[] = [
  { href: "https://github.com/idiegoo", label: "GitHub", icon: "github" },
  {
    href: "https://linkedin.com/in/idiegoo",
    label: "LinkedIn",
    icon: "linkedin",
  },
  { href: "mailto:idiegocs9@gmail.com", label: "Email", icon: "mail" },
];
---

<section
  id="home"
  class="min-h-screen flex items-center justify-center relative overflow-hidden"
>
  <!-- Animated background effects -->
  <div class="absolute inset-0">
    <!-- (Background image removed; volcano image used as profile image instead) -->
    <div
      class="absolute top-1/4 left-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-pulse"
    >
    </div>
    <div
      class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-green-500/10 rounded-full blur-3xl animate-pulse"
      style="animation-delay: 1s;"
    >
    </div>
    <div
      class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-white/5 rounded-full blur-3xl animate-pulse"
      style="animation-delay: 0.5s;"
    >
    </div>
  </div>

  <div class="relative z-10 px-4 max-w-7xl mx-auto">
    <div class="flex flex-col lg:flex-row items-center lg:items-center gap-12 lg:gap-16">
      <!-- Profile Image - Top on mobile, left on large screens -->
      <div class="mt-8 lg:mt-0 flex-shrink-0 order-1 lg:order-1 flex justify-center lg:justify-start w-full lg:w-auto">
        <div class="relative">
          <!-- Outer gradient ring wrapper -->
          <div class="rounded-full p-1 bg-gradient-to-br from-purple-500/60 to-green-400/60 shadow-[0_0_40px_rgba(168,85,247,0.25)] hover:scale-105 transition-transform duration-300 inline-block">
            <!-- Inner image container, keeps original sizing -->
            <div class="w-48 sm:w-64 md:w-80 h-48 sm:h-64 md:h-80 rounded-full overflow-hidden border-2 border-white/10 bg-black">
              <img
                src="/images/playa.webp"
                alt="Diego Aguirre - Full Stack Developer"
                class="w-full h-full object-cover"
                fetchpriority="high"
              />
            </div>
          </div>
          <!-- Decorative elements -->
          <div
            class="absolute -top-4 -right-4 w-12 sm:w-16 md:w-20 h-12 sm:h-16 md:h-20 bg-gradient-to-br from-purple-400 to-green-400 rounded-full opacity-20 animate-pulse"
          >
          </div>
          <div
            class="absolute -bottom-6 -left-6 w-10 sm:w-12 md:w-16 h-10 sm:h-12 md:h-16 bg-gradient-to-tr from-green-400 to-purple-400 rounded-full opacity-30 animate-pulse"
            style="animation-delay: 1s;"
          >
          </div>
        </div>
      </div>

      <!-- Content - Right side on large screens -->
      <div class="flex-1 text-center lg:text-left order-2 lg:order-2 mb-8 w-full lg:w-auto lg:pt-8">
        <h1
          class="text-5xl md:text-7xl font-bold mb-6 bg-gradient-to-r from-white via-purple-300 to-green-300 bg-clip-text text-transparent py-2 leading-tight"
        >
          {t("hero.title")}
        </h1>
        <div
          class="mb-6 bg-gray-900/50 backdrop-blur-sm border border-white/10 rounded-2xl px-6 py-4 inline-flex items-center shadow-[0_0_20px_rgba(255,255,255,0.3)] mx-auto lg:mx-0"
        >
          <span
            class="mr-2 text-xl md:text-2xl font-medium text-gray-300 whitespace-nowrap"
            >{t("hero.loader.building")}</span
          >
          <div class="h-8">
            <RotatingText
              client:load
              texts={[
                t("hero.loader.web"),
                t("hero.loader.mobile"),
                t("hero.loader.apis"),
                t("hero.loader.automation"),
                t("hero.loader.solutions"),
              ]}
              mainClassName="px-2 sm:px-1 md:px-3 bg-gradient-to-r from-purple-500 to-purple-700 overflow-hidden justify-center rounded-lg text-xl md:text-2xl"
              staggerFrom={"last"}
              initial={{ y: "100%" }}
              animate={{ y: 0 }}
              exit={{ y: "-120%" }}
              staggerDuration={0.02}
              splitLevelClassName="overflow-hidden pb-0.5 sm:pb-1 md:pb-1"
              elementLevelClassName="font-bold text-gray-900"
              transition={{ type: "spring", damping: 30, stiffness: 400 }}
              rotationInterval={2000}
            />
          </div>
        </div>
        <div class="w-sm items-center justify-center text-center lg:text-left lg:w-auto mx-auto lg:mx-0">
          <p class="text-xl font-bold md:text-2xl text-gray-300 mb-8 leading-relaxed">
            {t("hero.subtitle")}
          </p>
          <p class="text-lg font-medium text-gray-400 max-w-2xl mb-12 px-2 md:px-0 mx-auto lg:mx-0">
            {t("hero.description")}
          </p>
        </div>
      </div>
    </div>

    <div
      class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-12 md:mt-12"
    >
      <a
        href="#projects"
        class="inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-lg bg-gradient-to-r from-purple-600 to-green-600 hover:from-purple-700 hover:to-green-700 text-white shadow-[0_0_20px_rgba(168,85,247,0.3)] hover:shadow-[0_0_30px_rgba(168,85,247,0.5)] transition-all duration-300"
      >
        {t("hero.viewWork")}
      </a>
      <a
        href="/cv.pdf"
        download
        class="inline-flex items-center justify-center px-8 py-3 text-lg font-medium rounded-lg border border-white/20 text-white hover:bg-white/10 hover:shadow-[0_0_20px_rgba(255,255,255,0.2)] bg-transparent transition-all duration-300"
      >
        {t("hero.downloadCV")}
      </a>
    </div>

    <div class="flex justify-center space-x-6 mb-12">
      {
        socialLinks.map(({ href, label, icon }) => (
          <a
            href={href}
            class={`group p-3 rounded-full border border-white/20 transition-all duration-300 ${
              icon === "github"
                ? "hover:border-gray-400/50 hover:bg-gray-500/10 hover:shadow-[0_0_15px_rgba(156,163,175,0.4)]"
                : icon === "linkedin"
                  ? "hover:border-blue-400/50 hover:bg-blue-500/10 hover:shadow-[0_0_15px_rgba(59,130,246,0.4)]"
                  : icon === "mail"
                    ? "hover:border-red-400/50 hover:bg-red-500/10 hover:shadow-[0_0_15px_rgba(239,68,68,0.4)]"
                    : ""
            }`}
            aria-label={label}
            target="_blank"
            rel="noopener noreferrer"
          >
            <Icons
              icon={icon}
              size={24}
              brandColors={true}
              class="text-white"
            />
          </a>
        ))
      }
    </div>

    <div class="animate-bounce">
      <Icons icon="arrow-down" size={32} class="mx-auto text-gray-400" />
    </div>
  </div>
</section>

<style>
  .card {
    /* color used to softly clip top and bottom of the .words container */
    --bg-color: #111;
    background-color: var(--bg-color);
    padding: 1rem 2rem;
    border-radius: 1.25rem;
  }
  .loader {
    color: rgb(124, 124, 124);
    font-family: "Poppins", sans-serif;
    font-weight: 500;
    font-size: 25px;
    -webkit-box-sizing: content-box;
    box-sizing: content-box;
    height: 40px;
    padding: 10px 10px;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    border-radius: 8px;
  }

  .words {
    overflow: hidden;
    position: relative;
  }
  .words::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      var(--bg-color) 10%,
      transparent 30%,
      transparent 70%,
      var(--bg-color) 90%
    );
    z-index: 20;
  }

  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .animate-bounce {
    animation: bounce 1s infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  @keyframes bounce {
    0%,
    100% {
      transform: translateY(0);
      animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
    }
    50% {
      transform: translateY(-25%);
      animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
    }
  }
</style>
